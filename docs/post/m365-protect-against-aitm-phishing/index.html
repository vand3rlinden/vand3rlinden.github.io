<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Microsoft 365: Protect your environment against AiTM phishing attacks | VAND3RLINDEN</title>
<meta name="keywords" content="">
<meta name="description" content="
In this blog post, we’ll walk through practical strategies to reduce the likelihood and impact of successful AiTM phishing attacks in Microsoft 365.
In today’s threat landscape, adversary-in-the-middle (AiTM) phishing attacks have emerged as a particularly dangerous tactic. These attacks bypass traditional defenses by placing a malicious proxy between the user and the legitimate service, capturing credentials and session tokens in real time. Once attackers have session tokens, they can bypass even multi-factor authentication (MFA), making AiTM attacks especially difficult to defend against.">
<meta name="author" content="">
<link rel="canonical" href="https://vand3rlinden.com/post/m365-protect-against-aitm-phishing/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.93f625d739f1d6a5c6f20c146bc6a8d26b233492b34b2220c54b12fd46a04ded.css" integrity="sha256-k/Yl1znx1qXG8gwUa8ao0msjNJKzSyIgxUsS/UagTe0=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://vand3rlinden.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://vand3rlinden.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://vand3rlinden.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://vand3rlinden.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://vand3rlinden.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://vand3rlinden.com/post/m365-protect-against-aitm-phishing/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://vand3rlinden.com/post/m365-protect-against-aitm-phishing/">
  <meta property="og:site_name" content="VAND3RLINDEN">
  <meta property="og:title" content="Microsoft 365: Protect your environment against AiTM phishing attacks">
  <meta property="og:description" content=" In this blog post, we’ll walk through practical strategies to reduce the likelihood and impact of successful AiTM phishing attacks in Microsoft 365.
In today’s threat landscape, adversary-in-the-middle (AiTM) phishing attacks have emerged as a particularly dangerous tactic. These attacks bypass traditional defenses by placing a malicious proxy between the user and the legitimate service, capturing credentials and session tokens in real time. Once attackers have session tokens, they can bypass even multi-factor authentication (MFA), making AiTM attacks especially difficult to defend against.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-03-23T22:52:19+01:00">
    <meta property="article:modified_time" content="2025-03-23T22:52:19+01:00">
    <meta property="og:image" content="https://vand3rlinden.com/images/m365-protect-against-aitm-phishing/m365-protect-against-aitm-phishing-front.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://vand3rlinden.com/images/m365-protect-against-aitm-phishing/m365-protect-against-aitm-phishing-front.png">
<meta name="twitter:title" content="Microsoft 365: Protect your environment against AiTM phishing attacks">
<meta name="twitter:description" content="
In this blog post, we’ll walk through practical strategies to reduce the likelihood and impact of successful AiTM phishing attacks in Microsoft 365.
In today’s threat landscape, adversary-in-the-middle (AiTM) phishing attacks have emerged as a particularly dangerous tactic. These attacks bypass traditional defenses by placing a malicious proxy between the user and the legitimate service, capturing credentials and session tokens in real time. Once attackers have session tokens, they can bypass even multi-factor authentication (MFA), making AiTM attacks especially difficult to defend against.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://vand3rlinden.com/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Microsoft 365: Protect your environment against AiTM phishing attacks",
      "item": "https://vand3rlinden.com/post/m365-protect-against-aitm-phishing/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Microsoft 365: Protect your environment against AiTM phishing attacks",
  "name": "Microsoft 365: Protect your environment against AiTM phishing attacks",
  "description": " In this blog post, we’ll walk through practical strategies to reduce the likelihood and impact of successful AiTM phishing attacks in Microsoft 365.\nIn today’s threat landscape, adversary-in-the-middle (AiTM) phishing attacks have emerged as a particularly dangerous tactic. These attacks bypass traditional defenses by placing a malicious proxy between the user and the legitimate service, capturing credentials and session tokens in real time. Once attackers have session tokens, they can bypass even multi-factor authentication (MFA), making AiTM attacks especially difficult to defend against.\n",
  "keywords": [
    
  ],
  "articleBody": " In this blog post, we’ll walk through practical strategies to reduce the likelihood and impact of successful AiTM phishing attacks in Microsoft 365.\nIn today’s threat landscape, adversary-in-the-middle (AiTM) phishing attacks have emerged as a particularly dangerous tactic. These attacks bypass traditional defenses by placing a malicious proxy between the user and the legitimate service, capturing credentials and session tokens in real time. Once attackers have session tokens, they can bypass even multi-factor authentication (MFA), making AiTM attacks especially difficult to defend against.\nWhile there is no single configuration to fully prevent AiTM phishing attacks in Microsoft 365 environments, a layered defense strategy can significantly reduce risk. This includes a combination of user education, strong authentication methods, and granular Conditional Access policies.\nPath of an AiTM Phishing Attack The attack typically follows these steps:\nPhishing Email Received\nThe user receives a phishing email that may closely resemble a legitimate message.\nUser Clicks the Link\nIf the user doesn’t recognize any red flags in the email and clicks the link, they are redirected to an AiTM phishing site that mimics a real login page.\nCredential Harvesting\nIf the user also fails to notice red flags in the URL and enters their credentials, the attacker is able to intercept and steal authorization tokens, giving them access to the user’s session, even with MFA enabled.\nThis illustrates how AiTM phishing attacks bypass traditional authentication defenses by hijacking active sessions.\nTrain Your Users – The First Line of Defense Human error remains one of the leading causes of successful phishing attacks. No technical control can completely compensate for an untrained or unaware user.\nAttack simulation training using Microsoft Defender for Office 365 or other platforms, such as Knowbe4, allows organizations to run real-world phishing simulations and educate users on how to spot suspicious links, spoofed login pages, or unexpected MFA prompts.\nPhishing-Resistant MFA Not all MFA methods are created equal. Most AiTM attacks work because they can intercept standard MFA flows like SMS or app-based codes. To defend effectively, organizations should enforce phishing-resistant MFA methods such as: FIDO2 security keys, these hardware-based tokens that are inherently resistant to AiTM attacks. This is because FIDO2 authentication is bound to the specific origin (i.e., the legitimate website or application). A sign-in attempt on a different surface, such as a phishing site, will fail if the origin does not match. This effectively prevents credentials from being reused on malicious or unauthorized platforms.\nEnable passkeys (FIDO2) for your organization\nHarden Conditional Access Policies Enforce Phishing-Resistant MFA Start by securing admin accounts first. Accounts with highly privileged administrative rights are frequent targets for attackers. Enforcing phishing-resistant MFA on these accounts is a straightforward and effective way to significantly reduce the risk of compromise.\nPolicy Implementation\nTip: When using eligible roles in PIM (Privileged Identity Management), it’s recommended to include an Entra ID group, preferably a dynamic group based on your admin naming convention (e.g., ‘adm’), instead of include roles directly to the Conditional Access Policy. Also include an Entra ID group with the standard (non-privileged) accounts of the admins, as attackers can often find information online (e.g., LinkedIn) and target them with phishing emails sent to their regular user accounts.\nRequire compliant devices To ensure that only trusted and compliant devices can access corporate resources, you may want to start by applying these restrictions to admin accounts. As mentioned earlier in this blog, accounts with administrative privileges are prime targets for attackers. Requiring these users to operate only from compliant or Microsoft Entra hybrid joined devices helps reduce the risk of compromise and limits potential exposure.\nWhy it helps: Blocks attackers using stolen credentials via AiTM phishing, even if they bypass MFA, because their device won’t meet compliance requirements.\nPolicy Implementation\nTip: When using eligible roles in PIM (Privileged Identity Management), it’s recommended to include an Entra ID group, preferably a dynamic group based on your admin naming convention (e.g., ‘adm’), instead of include roles directly to the Conditional Access Policy. Also include an Entra ID group with the standard (non-privileged) accounts of the admins, as attackers can often find information online (e.g., LinkedIn) and target them with phishing emails sent to their regular user accounts.\nRestrict Access by Network Location Implement location-based Conditional Access policies to limit access to specific countries or trusted IP ranges.\nExample: Allow sign-ins only from countries where your organization operates. Why it helps: Many AiTM attacks originate from foreign IP addresses. Restricting logins to known geographies can immediately block these attempts.\nPolicy Implementation\nEnable Risk Policies Allows you to define automatic responses, such as enforcing multi-factor authentication (MFA), blocking access, or requiring a password reset when certain risk thresholds are met.\nUser risk policy: Automatically respond when a user’s account is compromised. Sign-in risk policy: Require MFA or block access when risk is high. Policy Implementation\nRequire re-authentication and disable browser persistence Protect user access on unmanaged devices by configuring browser sessions to sign out automatically when the browser is closed and setting the sign-in frequency to 1 hour. This reduces the risk of unauthorized access by ensuring users must re-authenticate regularly and session data is not retained.\nWhy it helps:\nSign-in frequency: By default, users in Microsoft Entra ID can remain signed in to applications like Microsoft 365 for up to 90 days without reauthenticating. Enforcing a timeout for MFA helps ensure that sessions are not kept alive indefinitely, enhancing security by requiring users to re-authenticate periodically.\nPersistent browser session - Never persistent: The concept of a non-persistent browser session is designed to prevent users from remaining signed in after closing their browser. Disabling browser persistent sessions helps protect against drive-by attacks by preventing the creation and storage of session cookies, leaving nothing behind for an attacker to steal. While this does not prevent AiTM attacks, since AiTM targets active sessions rather than stored session data, non-persistent sessions still contribute to a layered defense. They help by limiting the time an attacker can use stolen session tokens, enforcing more frequent reauthentication.\nPolicy Implementation\nRequire token protection for sign-in sessions Microsoft is rolling out token protection to combat token theft. As of now, it’s supported for SharePoint Online and Exchange Online.\nHow token protection works:\nToken protection binds access tokens to the device they were issued on. If the token is stolen and used elsewhere, it will fail authorization even if the session was authenticated. Important: AiTM phishing kits can still successfully steal the token and initiate a session. However, with token protection, authorization will fail unless the token is used from the original device. This makes token theft less valuable for attackers and adds another hurdle for them to overcome.\nPolicy Implementation - preview\nHarden Microsoft Defender Block Risky Web Categories with Microsoft Defender for Endpoint AiTM phishing kits often use newly registered domains and parked domains to host their proxy phishing sites. These domains are frequently created just hours before an attack to avoid detection by traditional domain reputation engines.\nTo proactively block access to such sites, you can configure web content filtering in Microsoft Defender for Endpoint:\nIn the Microsoft 365 Defender portal, go to Settings \u003e Endpoints \u003e Advanced features \u003e Enable: Web content filtering. Once enabled, navigate to: Endpoints \u003e Web content filtering Create a policy that blocks the following categories: Newly Registered Domains Parked Domains These categories are frequently leveraged by threat actors to bypass email filters and trick users into entering their credentials.\nWhy it helps: Blocking access to these domains prevents users from ever reaching the phishing page, even if they click a link in a legitimate-looking email.\nThis is especially effective when combined with Defender SmartScreen and Network Protection policies to stop outbound access to malicious or suspicious domains.\nConfigure Automatic Attack Disruption in Microsoft Defender XDR Attackers move fast, sometimes within minutes of obtaining access. That’s why it’s crucial to respond faster.\nMicrosoft Defender XDR now offers automatic attack disruption, which can take immediate action when high-confidence signals of compromise are detected. This capability works across Defender for Endpoint, Defender for Identity, Defender for Office 365, and Defender for Cloud Apps.\nWhat it does:\nAutomatically isolates compromised user accounts or devices. Disrupts lateral movement and command-and-control activity. Uses AI to correlate telemetry across workloads and identify active attacks. Configure automatic attack disruption in Microsoft Defender XDR\nWhy it helps: Even if AiTM phishing is successful and the attacker gains a foothold, automatic attack disruption can contain the threat before significant damage occurs.\nSummary AiTM phishing attacks are hard to stop with a single control. By combining phishing-resistant MFA, Conditional Access policies, risk-based access controls, token protection, web filtering, user training, and automatic attack disruption in Microsoft Defender XDR, you build a strong, layered defense. The goal isn’t just to prevent attacks, but to detect, contain, and respond before damage is done. Defense in depth is your best strategy in the evolving threat landscape.\n",
  "wordCount" : "1480",
  "inLanguage": "en",
  "image":"https://vand3rlinden.com/images/m365-protect-against-aitm-phishing/m365-protect-against-aitm-phishing-front.png","datePublished": "2025-03-23T22:52:19+01:00",
  "dateModified": "2025-03-23T22:52:19+01:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://vand3rlinden.com/post/m365-protect-against-aitm-phishing/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "VAND3RLINDEN",
    "logo": {
      "@type": "ImageObject",
      "url": "https://vand3rlinden.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://vand3rlinden.com/" accesskey="h" title="VAND3RLINDEN (Alt + H)">VAND3RLINDEN</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://vand3rlinden.com/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://vand3rlinden.com/post/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://vand3rlinden.com/pgp" title="PGP">
                    <span>PGP</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://vand3rlinden.com/">Home</a>&nbsp;»&nbsp;<a href="https://vand3rlinden.com/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Microsoft 365: Protect your environment against AiTM phishing attacks
    </h1>
    <div class="post-meta"><span title='2025-03-23 22:52:19 +0100 CET'>March 23, 2025</span>&nbsp;·&nbsp;7 min

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="https://vand3rlinden.com/images/m365-protect-against-aitm-phishing/m365-protect-against-aitm-phishing-front.png" alt="">
        
</figure>
  <div class="post-content"><blockquote>
<p><em>In this blog post, we’ll walk through practical strategies to reduce the likelihood and impact of successful AiTM phishing attacks in Microsoft 365.</em></p></blockquote>
<p>In today’s threat landscape, adversary-in-the-middle (AiTM) phishing attacks have emerged as a particularly dangerous tactic. These attacks bypass traditional defenses by placing a malicious proxy between the user and the legitimate service, capturing credentials and session tokens in real time. Once attackers have session tokens, they can bypass even multi-factor authentication (MFA), making AiTM attacks especially difficult to defend against.</p>
<p>While there is no single configuration to fully prevent AiTM phishing attacks in Microsoft 365 environments, a layered defense strategy can significantly reduce risk. This includes a combination of user education, strong authentication methods, and granular Conditional Access policies.</p>
<h2 id="path-of-an-aitm-phishing-attack">Path of an AiTM Phishing Attack<a hidden class="anchor" aria-hidden="true" href="#path-of-an-aitm-phishing-attack">#</a></h2>
<p>The attack typically follows these steps:</p>
<ol>
<li>
<p><strong>Phishing Email Received</strong><br>
The user receives a phishing email that may closely resemble a legitimate message.</p>
<p><img alt="IMAGE" loading="lazy" src="/images/m365-protect-against-aitm-phishing/m365-protect-against-aitm-phishing-1.png"></p>
</li>
<li>
<p><strong>User Clicks the Link</strong><br>
If the user doesn&rsquo;t recognize any red flags in the email and clicks the link, they are redirected to an <strong>AiTM phishing site</strong> that mimics a real login page.</p>
<p><img alt="IMAGE" loading="lazy" src="/images/m365-protect-against-aitm-phishing/m365-protect-against-aitm-phishing-2.png"></p>
</li>
<li>
<p><strong>Credential Harvesting</strong><br>
If the user also fails to notice red flags in the URL and enters their credentials, the attacker is able to intercept and steal <strong>authorization tokens</strong>, giving them access to the user’s session, even with MFA enabled.</p>
<p><img alt="IMAGE" loading="lazy" src="/images/m365-protect-against-aitm-phishing/m365-protect-against-aitm-phishing-3.png"></p>
</li>
</ol>
<p>This illustrates how AiTM phishing attacks bypass traditional authentication defenses by hijacking active sessions.</p>
<h2 id="train-your-users--the-first-line-of-defense">Train Your Users – The First Line of Defense<a hidden class="anchor" aria-hidden="true" href="#train-your-users--the-first-line-of-defense">#</a></h2>
<p>Human error remains one of the leading causes of successful phishing attacks. No technical control can completely compensate for an untrained or unaware user.</p>
<p><a href="https://vand3rlinden.com/post/mdo-attack-simulation/">Attack simulation training using Microsoft Defender for Office 365</a> or other platforms, such as <strong>Knowbe4</strong>, allows organizations to run real-world phishing simulations and educate users on how to spot suspicious links, spoofed login pages, or unexpected MFA prompts.</p>
<h2 id="phishing-resistant-mfa">Phishing-Resistant MFA<a hidden class="anchor" aria-hidden="true" href="#phishing-resistant-mfa">#</a></h2>
<p>Not all MFA methods are created equal. Most AiTM attacks work because they can intercept standard MFA flows like SMS or app-based codes. To defend effectively, organizations should enforce phishing-resistant MFA methods such as: FIDO2 security keys, these hardware-based tokens that are inherently resistant to AiTM attacks. This is because FIDO2 authentication is bound to the specific origin (i.e., the legitimate website or application). A sign-in attempt on a different surface, such as a phishing site, will fail if the origin does not match. This effectively prevents credentials from being reused on malicious or unauthorized platforms.</p>
<p><a href="https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-enable-passkey-fido2">Enable passkeys (FIDO2) for your organization</a></p>
<h2 id="harden-conditional-access-policies">Harden Conditional Access Policies<a hidden class="anchor" aria-hidden="true" href="#harden-conditional-access-policies">#</a></h2>
<h3 id="enforce-phishing-resistant-mfa">Enforce Phishing-Resistant MFA<a hidden class="anchor" aria-hidden="true" href="#enforce-phishing-resistant-mfa">#</a></h3>
<p>Start by securing admin accounts first. Accounts with highly privileged administrative rights are frequent targets for attackers. Enforcing phishing-resistant MFA on these accounts is a straightforward and effective way to significantly reduce the risk of compromise.</p>
<p><a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-admin-phish-resistant-mfa">Policy Implementation</a></p>
<p>Tip: When using eligible roles in PIM (Privileged Identity Management), it’s recommended to include an Entra ID group, preferably a dynamic group based on your admin naming convention (e.g., ‘adm’), instead of include roles directly to the Conditional Access Policy. Also include an Entra ID group with the standard (non-privileged) accounts of the admins, as attackers can often find information online (e.g., LinkedIn) and target them with phishing emails sent to their regular user accounts.</p>
<h3 id="require-compliant-devices">Require compliant devices<a hidden class="anchor" aria-hidden="true" href="#require-compliant-devices">#</a></h3>
<p>To ensure that only trusted and compliant devices can access corporate resources, you may want to start by applying these restrictions to admin accounts. As mentioned earlier in this blog, accounts with administrative privileges are prime targets for attackers. Requiring these users to operate only from compliant or Microsoft Entra hybrid joined devices helps reduce the risk of compromise and limits potential exposure.</p>
<p>Why it helps: Blocks attackers using stolen credentials via AiTM phishing, even if they bypass MFA, because their device won’t meet compliance requirements.</p>
<p><a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-alt-admin-device-compliand-hybrid">Policy Implementation</a></p>
<p>Tip: When using eligible roles in PIM (Privileged Identity Management), it’s recommended to include an Entra ID group, preferably a dynamic group based on your admin naming convention (e.g., ‘adm’), instead of include roles directly to the Conditional Access Policy. Also include an Entra ID group with the standard (non-privileged) accounts of the admins, as attackers can often find information online (e.g., LinkedIn) and target them with phishing emails sent to their regular user accounts.</p>
<h3 id="restrict-access-by-network-location">Restrict Access by Network Location<a hidden class="anchor" aria-hidden="true" href="#restrict-access-by-network-location">#</a></h3>
<p>Implement location-based Conditional Access policies to limit access to specific countries or trusted IP ranges.</p>
<ul>
<li>Example: Allow sign-ins only from countries where your organization operates.</li>
</ul>
<p>Why it helps: Many AiTM attacks originate from foreign IP addresses. Restricting logins to known geographies can immediately block these attempts.</p>
<p><a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-block-by-location">Policy Implementation</a></p>
<h3 id="enable-risk-policies">Enable Risk Policies<a hidden class="anchor" aria-hidden="true" href="#enable-risk-policies">#</a></h3>
<p>Allows you to define automatic responses, such as enforcing multi-factor authentication (MFA), blocking access, or requiring a password reset when certain risk thresholds are met.</p>
<ul>
<li>User risk policy: Automatically respond when a user’s account is compromised.</li>
<li>Sign-in risk policy: Require MFA or block access when risk is high.</li>
</ul>
<p><a href="https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-risk-policies">Policy Implementation</a></p>
<h3 id="require-re-authentication-and-disable-browser-persistence">Require re-authentication and disable browser persistence<a hidden class="anchor" aria-hidden="true" href="#require-re-authentication-and-disable-browser-persistence">#</a></h3>
<p>Protect user access on unmanaged devices by configuring browser sessions to sign out automatically when the browser is closed and setting the sign-in frequency to 1 hour. This reduces the risk of unauthorized access by ensuring users must re-authenticate regularly and session data is not retained.</p>
<p>Why it helps:</p>
<ul>
<li>
<p>Sign-in frequency: By default, users in Microsoft Entra ID can remain signed in to applications like Microsoft 365 for up to 90 days without reauthenticating. Enforcing a timeout for MFA helps ensure that sessions are not kept alive indefinitely, enhancing security by requiring users to re-authenticate periodically.</p>
</li>
<li>
<p>Persistent browser session - Never persistent: The concept of a non-persistent browser session is designed to prevent users from remaining signed in after closing their browser. Disabling browser persistent sessions helps protect against drive-by attacks by preventing the creation and storage of session cookies, leaving nothing behind for an attacker to steal. While this does not prevent AiTM attacks, since AiTM targets active sessions rather than stored session data, non-persistent sessions still contribute to a layered defense. They help by limiting the time an attacker can use stolen session tokens, enforcing more frequent reauthentication.</p>
</li>
</ul>
<p><a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/policy-all-users-persistent-browser">Policy Implementation</a></p>
<h3 id="require-token-protection-for-sign-in-sessions">Require token protection for sign-in sessions<a hidden class="anchor" aria-hidden="true" href="#require-token-protection-for-sign-in-sessions">#</a></h3>
<p>Microsoft is rolling out token protection to combat token theft. As of now, it’s supported for <strong>SharePoint Online</strong> and <strong>Exchange Online</strong>.</p>
<p>How token protection works:</p>
<ul>
<li>Token protection binds access tokens to the device they were issued on.</li>
<li>If the token is stolen and used elsewhere, it will fail authorization even if the session was authenticated.</li>
</ul>
<blockquote>
<p>Important: AiTM phishing kits can still successfully steal the token and initiate a session. However, with token protection, authorization will fail unless the token is used from the original device. This makes token theft less valuable for attackers and adds another hurdle for them to overcome.</p></blockquote>
<p><a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-token-protection">Policy Implementation - preview</a></p>
<h2 id="harden-microsoft-defender">Harden Microsoft Defender<a hidden class="anchor" aria-hidden="true" href="#harden-microsoft-defender">#</a></h2>
<h3 id="block-risky-web-categories-with-microsoft-defender-for-endpoint">Block Risky Web Categories with Microsoft Defender for Endpoint<a hidden class="anchor" aria-hidden="true" href="#block-risky-web-categories-with-microsoft-defender-for-endpoint">#</a></h3>
<p>AiTM phishing kits often use newly registered domains and parked domains to host their proxy phishing sites. These domains are frequently created just hours before an attack to avoid detection by traditional domain reputation engines.</p>
<p>To proactively block access to such sites, you can configure web content filtering in Microsoft Defender for Endpoint:</p>
<ul>
<li>In the Microsoft 365 Defender portal, go to Settings &gt; Endpoints &gt; Advanced features &gt; Enable: Web content filtering.</li>
<li>Once enabled, navigate to: Endpoints &gt; Web content filtering</li>
<li>Create a policy that blocks the following categories:
<ul>
<li>Newly Registered Domains</li>
<li>Parked Domains</li>
</ul>
</li>
</ul>
<p>These categories are frequently leveraged by threat actors to bypass email filters and trick users into entering their credentials.</p>
<p>Why it helps: Blocking access to these domains prevents users from ever reaching the phishing page, even if they click a link in a legitimate-looking email.</p>
<p>This is especially effective when combined with <a href="https://learn.microsoft.com/en-us/windows/security/operating-system-security/virus-and-threat-protection/microsoft-defender-smartscreen/">Defender SmartScreen</a> and <a href="https://learn.microsoft.com/en-us/defender-endpoint/enable-network-protection">Network Protection</a> policies to stop outbound access to malicious or suspicious domains.</p>
<h3 id="configure-automatic-attack-disruption-in-microsoft-defender-xdr">Configure Automatic Attack Disruption in Microsoft Defender XDR<a hidden class="anchor" aria-hidden="true" href="#configure-automatic-attack-disruption-in-microsoft-defender-xdr">#</a></h3>
<p>Attackers move fast, sometimes within minutes of obtaining access. That’s why it’s crucial to respond faster.</p>
<p>Microsoft Defender XDR now offers automatic attack disruption, which can take immediate action when high-confidence signals of compromise are detected. This capability works across Defender for Endpoint, Defender for Identity, Defender for Office 365, and Defender for Cloud Apps.</p>
<p>What it does:</p>
<ul>
<li>Automatically isolates compromised user accounts or devices.</li>
<li>Disrupts lateral movement and command-and-control activity.</li>
<li>Uses AI to correlate telemetry across workloads and identify active attacks.</li>
</ul>
<p><a href="https://learn.microsoft.com/en-us/defender-xdr/configure-attack-disruption">Configure automatic attack disruption in Microsoft Defender XDR</a></p>
<p>Why it helps: Even if AiTM phishing is successful and the attacker gains a foothold, automatic attack disruption can contain the threat before significant damage occurs.</p>
<h2 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h2>
<p>AiTM phishing attacks are hard to stop with a single control. By combining phishing-resistant MFA, Conditional Access policies, risk-based access controls, token protection, web filtering, user training, and automatic attack disruption in Microsoft Defender XDR, you build a strong, layered defense. The goal isn’t just to prevent attacks, but to detect, contain, and respond before damage is done. Defense in depth is your best strategy in the evolving threat landscape.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://vand3rlinden.com/post/mdo-rfc-compliant-emails/">
    <span class="title">« Prev</span>
    <br>
    <span>Microsoft Defender for Office 365: Approach for Non-RFC compliant emails</span>
  </a>
  <a class="next" href="https://vand3rlinden.com/post/mdo-handling-false-positives-false-negatives/">
    <span class="title">Next »</span>
    <br>
    <span>Microsoft Defender for Office 365: Handling False Positives and False Negatives</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Microsoft 365: Protect your environment against AiTM phishing attacks on x"
            href="https://x.com/intent/tweet/?text=Microsoft%20365%3a%20Protect%20your%20environment%20against%20AiTM%20phishing%20attacks&amp;url=https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Microsoft 365: Protect your environment against AiTM phishing attacks on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f&amp;title=Microsoft%20365%3a%20Protect%20your%20environment%20against%20AiTM%20phishing%20attacks&amp;summary=Microsoft%20365%3a%20Protect%20your%20environment%20against%20AiTM%20phishing%20attacks&amp;source=https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Microsoft 365: Protect your environment against AiTM phishing attacks on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f&title=Microsoft%20365%3a%20Protect%20your%20environment%20against%20AiTM%20phishing%20attacks">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Microsoft 365: Protect your environment against AiTM phishing attacks on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Microsoft 365: Protect your environment against AiTM phishing attacks on whatsapp"
            href="https://api.whatsapp.com/send?text=Microsoft%20365%3a%20Protect%20your%20environment%20against%20AiTM%20phishing%20attacks%20-%20https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Microsoft 365: Protect your environment against AiTM phishing attacks on telegram"
            href="https://telegram.me/share/url?text=Microsoft%20365%3a%20Protect%20your%20environment%20against%20AiTM%20phishing%20attacks&amp;url=https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Microsoft 365: Protect your environment against AiTM phishing attacks on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Microsoft%20365%3a%20Protect%20your%20environment%20against%20AiTM%20phishing%20attacks&u=https%3a%2f%2fvand3rlinden.com%2fpost%2fm365-protect-against-aitm-phishing%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://vand3rlinden.com/">VAND3RLINDEN</a></span> · 

    <span>
        <a href="https://vand3rlinden.com/privacy-policy" rel="noopener noreferrer" target="_blank">Privacy Policy</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
