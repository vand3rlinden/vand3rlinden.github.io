---
title: 'Microsoft Defender for Office 365: Anti-malware policies'
date: 2023-12-23T23:07:45+01:00
draft: false
categories: ["Microsoft Defender for Office 365"]
cover: 
  image: /images/mdo-anti-malware-policies/mdo-anti-malware-policies-front.png
---

> _Malware is specifically designed to harm or exploit devices, networks, or users. It includes various types of harmful software such as viruses, worms, trojan horses, ransomware, spyware, and adware. Malware can be distributed through email attachments, infected websites, malicious downloads, or other deceptive means._

## What you can manage with an Anti-malware policy
Mailboxes in Exchange Online benefit from automatic protection against malware through Exchange Online Protection (EOP). EOP offers a multi-layered malware protection system designed to detect all known malware.

Moreover, the anti-malware policies in MDO provide an additional layer of protection by blocking specific file types for both inbound and outbound mail traffic. The policy can also utilize ZAP (Zero-hour Auto Purge) to quarantine messages found to contain malware after they have been delivered to Exchange Online mailboxes; this setting is enabled by default.


## Anti-malware policy configuration
An out-of-the-box default policy is already enabled for all mailboxes in Exchange Online. While you have the option to create a new anti-malware policy to specify inclusion or exclusion of users, groups, or domains, it is advisable to stick with the default policy. This default policy is already activated for all Exchange Online mailboxes, and there is generally no need for exclusions in this case.

1. Sign in to the Microsoft Defender portal and navigate to the [Anti-malware section](https://security.microsoft.com/antimalwarev2).

2. Access the default anti-malware policy and select 'Edit protection settings'.

3. Activate the attachment filter, which comes preconfigured with 43 blocked file types such as ```.apk```, ```.iso```, and ```.cmd``` files.

Considering additional security measures, it’s prudent to contemplate blocking other file types like .doc, known for potentially harboring malicious macros, and .htm/.html files, which adversaries commonly exploit in Man-in-the-Middle (MITM) attacks.

![IMAGE](/images/mdo-anti-malware-policies/mdo-anti-malware-policies-aitm.png)

After compiling a list of undesired file types, you have the option to add them either individually or in bulk utilizing the ExchangeOnlineManagement PowerShell module. To accomplish this, execute the following script.

```
$Values = (Get-MalwareFilterPolicy -Identity Default).FileTypes
$Values += "htm","html","doc"
Set-MalwareFilterPolicy -Identity Default -EnableFileFilter $true -FileTypes $Values
```

4. You have the option to determine the course of action for inbound and outbound messages containing the specified undesirable file types. Opting for 'Reject the message with a non-delivery receipt (NDR)' is advisable, the Quarantine policy selection will be disregarded in this case.

5. Save your policy, and your organization will be enhanced in its defense against potential email attacks where malicious files are utilized.

## Ending up
While file sharing is a normal and non-malicious activity, the current landscape of email attacks suggests that relying on email for such exchanges might not be the most secure approach. In today’s environment, tools like OneDrive offer more secure alternatives for sharing files. Considering the prevalence of email attacks, it’s advisable for individuals and organizations to reduce the practice of sharing most files via email.

## Reference 
- [Anti-malware protection](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-malware-protection-about)
